<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test JSON Pur - Connect People</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success { border-color: #4CAF50; background-color: #f1f8e9; }
        .error { border-color: #f44336; background-color: #ffebee; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
        .console-output {
            background: #000;
            color: #0f0;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            margin: 10px 0;
            min-height: 100px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ§ª Test JSON Pur - Connect People</h1>
        <p>Cette page teste que l'API retourne UNIQUEMENT du JSON brut, sans aucune balise HTML.</p>
        
        <div class="test-section">
            <h3>Test 1: Route API Test Simple</h3>
            <button onclick="testAPI('/api/pages/test')">Tester /api/pages/test</button>
            <div id="test1-result"></div>
        </div>
        
        <div class="test-section">
            <h3>Test 2: Route API Page Home</h3>
            <button onclick="testAPI('/api/pages/page/home')">Tester /api/pages/page/home</button>
            <div id="test2-result"></div>
        </div>
        
        <div class="test-section">
            <h3>Test 3: Route API Page Test</h3>
            <button onclick="testAPI('/api/pages/page/t')">Tester /api/pages/page/t</button>
            <div id="test3-result"></div>
        </div>
        
        <div class="test-section">
            <h3>Console Output (Doit afficher UNIQUEMENT du JSON)</h3>
            <div id="console-output" class="console-output">Cliquez sur un bouton de test pour voir la sortie...</div>
        </div>
        
        <div class="test-section">
            <h3>Instructions</h3>
            <ol>
                <li>Ouvrez les DevTools (F12)</li>
                <li>Allez dans l'onglet <strong>Console</strong></li>
                <li>Cliquez sur les boutons de test ci-dessus</li>
                <li>VÃ©rifiez que la console affiche UNIQUEMENT du JSON brut</li>
                <li>VÃ©rifiez qu'il n'y a AUCUNE balise HTML visible</li>
            </ol>
        </div>
    </div>

    <script>
        // Capturer les console.log pour les afficher dans la page
        const originalLog = console.log;
        const consoleOutput = document.getElementById('console-output');
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            consoleOutput.innerHTML += args.map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
            ).join(' ') + '\n';
        };

        async function testAPI(url) {
            const resultDiv = document.getElementById(url.replace('/api/pages/', '').replace('/', '-') + '-result');
            resultDiv.innerHTML = '<p>Test en cours...</p>';

            try {
                console.log(`========== TEST: ${url} ==========`);
                console.log(`Fetching: ${url}`);
                
                const response = await fetch(url);
                const data = await response.json();
                
                // Afficher UNIQUEMENT le JSON brut dans la console
                console.log('Response JSON:', data);
                console.log(`========== FIN TEST: ${url} ==========\n`);
                
                // VÃ©rifier que c'est bien du JSON
                const isValidJSON = typeof data === 'object' && data !== null;
                const hasHTMLTags = JSON.stringify(data).match(/<[^>]+>/g);
                
                let status = 'success';
                let message = 'âœ“ Test rÃ©ussi: JSON brut reÃ§u';
                
                if (hasHTMLTags) {
                    status = 'error';
                    message = 'âœ— Erreur: Des balises HTML ont Ã©tÃ© dÃ©tectÃ©es dans la rÃ©ponse JSON';
                }
                
                if (!isValidJSON) {
                    status = 'error';
                    message = 'âœ— Erreur: La rÃ©ponse n\'est pas du JSON valide';
                }
                
                resultDiv.innerHTML = `
                    <p class="${status}">${message}</p>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
            } catch (error) {
                console.log(`========== ERREUR: ${url} ==========`);
                console.log(`Erreur: ${error.message}`);
                console.log(`========== FIN ERREUR: ${url} ==========\n`);
                
                resultDiv.innerHTML = `
                    <p class="error">âœ— Erreur: ${error.message}</p>
                `;
            }
        }

        // Test automatique au chargement de la page
        window.addEventListener('load', () => {
            console.log('Page de test chargÃ©e - PrÃªt pour les tests JSON');
        });
    </script>
</body>
</html>



